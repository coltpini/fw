var contextMenus,console=console||{log:function(){}},scripts=document.getElementsByTagName("script"),sd="";try{for(var i=0;i<scripts.length;i++){var s=scripts[i];if(s.src&&(s.src.search("contextMenu.js")>=0||s.src.search("contextMenu.js")>=0||s.src.search("contextMenu-min.js")>=0||s.src.search("contextMenu-min.js")>=0)){sd=s.src.toLowerCase().replace("http://","").replace("https://","");sd=sd.substring(0,sd.indexOf("/"));sd="//"+sd}}if(sd==="")throw"serviceDomain is empty";sd.search("localhost")>=0&&(sd="")}catch(e){console.log(e);sd="http://eadview.lds.org"}document.createStyleSheet?document.createStyleSheet(""+sd+"/resources/css/contextMenu.css"):document.write('<style>@import "'+sd+'/resources/css/contextMenu.css";</style>');(function(e,t){var n;contextMenus=function(){n=this};contextMenus.prototype.init=function(t){this.settings={passedMenus:[],defaultMenu:{},menus:[]};t&&e.extend(this.settings,t);this.buildMenus();this.applyMenus()};contextMenus.prototype.buildMenus=function(){this.settings.defaultMenu={name:"default",selector:"body",back:{text:"Back",action:"window.history.back();",order:0},collection:{text:"Collections",url:"/ead-module/collections/home",order:1}};this.settings.menus.push(this.settings.defaultMenu);for(i=0;i<this.settings.passedMenus.length;i++){var t=this.settings.passedMenus[i],r=e.extend({},this.settings.defaultMenu);e.extend(r,t);this.settings.menus.push(r)}e("body").append('<div class="contextMenu"></div>');this.settings.$cm=e(".contextMenu");this.settings.cm=this.settings.$cm[0];this.settings.$cm.mousedown(function(e){e.stopPropagation();e.which===3&&n.settings.$cm.fadeOut(100)});this.settings.$cm.on("mouseup","a,span",function(e){e.which===1&&n.settings.$cm.fadeOut(100)})};contextMenus.prototype.applyMenus=function(){for(i=0;i<this.settings.menus.length;i++){var t=this.settings.menus[i];e(document).on("mousedown",t.selector,t,function(e){n.createMenu(e,this)})}this.settings.menus.length>0&&e(document).on("contextmenu",function(){return!1})};contextMenus.prototype.createMenu=function(t,r){this.settings.currentE=t;if(t.which===3){t.preventDefault();t.stopPropagation();n.settings.$cm.html("");for(var i in t.data)if(t.data.hasOwnProperty(i)&&typeof t.data[i]=="object"){var s=t.data[i];typeof s.url!="undefined"?n.settings.$cm.append('<a href="'+s.url+'" >'+s.text+"</a>"):typeof s.action!="undefined"?n.settings.$cm.append('<span onclick="'+s.action+'" >'+s.text+"</span>"):n.settings.$cm.append(s.text)}var o=t.pageY,u=t.pageX,a=n.settings.$cm.outerWidth(),f=n.settings.$cm.outerHeight(),l=e(window).width(),c=e(window).height();u>l-a&&(u-=a);o>c-f&&(o-=f);n.settings.$cm.css({top:o,left:u});e(".contextMenu").fadeIn(100)}if(t.which===1&&this.settings.$cm.css("display")!=="none"){t.preventDefault();t.stopPropagation();n.settings.$cm.fadeOut(100)}}})(jQuery);